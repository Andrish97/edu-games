<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <title>Neon Arcade</title>

  <!-- WspÃ³lny motyw graficzny -->
  <link rel="stylesheet" href="css/arcade-theme.css">

  <!-- Supabase + rdzeÅ„ arcade (topbar, auth, backend progresu) -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="js/arcade-core.js"></script>
</head>
<body class="arcade-body">
  <!-- GÅ‚Ã³wna zawartoÅ›Ä‡ arcade (ukryta do czasu inicjalizacji) -->
  <div class="shell" id="arcade-main" style="display:none;">
    <div class="card">
      <div class="header">
        <div>
          <div class="title">Neon Arcade</div>
          <div class="subtitle">
            Wybierz kategoriÄ™, a potem grÄ™. KaÅ¼da uruchamia siÄ™ na caÅ‚e okno, wrÃ³cisz przyciskiem â€PowrÃ³t do Arcadeâ€.
          </div>
        </div>
      </div>

      <!-- Pasek kategorii -->
      <div class="categories-row" id="categories"></div>

      <!-- Gry z aktualnie wybranej kategorii -->
      <div id="games"></div>

      <div class="hint">
        Gry sÄ… generowane automatycznie z list w JavaScript. Å»eby dodaÄ‡ nowÄ…:
        dodaj plik <code>.html</code> i dopisz pozycjÄ™ do odpowiedniej tablicy
        (<code>CLASSIC_GAMES</code> lub <code>LANGUAGE_GAMES</code>).
      </div>
    </div>
  </div>

  <script>
    // ğŸ‘‡ Gry klasyczne â€“ w folderze classic/
    const CLASSIC_GAMES = [
      {
        id: "snake",
        file: "classic/snake.html",
        name: "Snake",
        icon: "ğŸ",
        thumb: "img/snake.png",
        description: "Klasyczny wÄ…Å¼ w neonowym wydaniu: przechodzi przez Å›ciany i przyÅ›piesza po zjedzeniu jabÅ‚ka."
      },
      {
        id: "tetris",
        file: "classic/tetris.html",
        name: "Tetris",
        icon: "ğŸ§±",
        thumb: "img/tetris.png",
        description: "Neonowe klocki, ghost piece, poziomy i przyspieszanie. Klasyk w pikselowym garniturze."
      },
      {
        id: "saper",
        file: "classic/saper.html",
        name: "Saper",
        icon: "ğŸ’£",
        thumb: "img/saper.png",
        description: "Minesweeper: rÃ³Å¼ne rozmiary planszy, proporcjonalna liczba min, pierwsze klikniÄ™cie zawsze bezpieczne."
      },
      {
        id: "wordl",
        file: "classic/wordl.html",
        name: "Wordl PL",
        icon: "ğŸ”¤",
        thumb: "img/wordl.png",
        description: "Polski Wordle: zgadnij sÅ‚owo 4â€“7 liter, sÅ‚ownik z internetu, kolorowe podpowiedzi jak w oryginale."
      },
      {
        id: "2048",
        file: "classic/2048.html",
        name: "2048",
        icon: "ğŸ”¢",
        thumb: "img/2048.png",
        description: "PÅ‚ynne, animowane 2048 z neonowymi kafelkami i lokalnym rekordem."
      },
      {
        id: "pong",
        file: "classic/pong.html",
        name: "Pong",
        icon: "ğŸ“",
        thumb: "img/pong.png",
        description: "Neonowy Pong z pÅ‚ynnÄ… piÅ‚kÄ…, prostym AI i sterowaniem W/S lub strzaÅ‚kami."
      }
    ];

    // ğŸ‘‡ Gry jÄ™zykowe â€“ w folderze language/
    const LANGUAGE_GAMES = [
      {
        id: "znajdz_slowo",
        file: "language/znajdz_slowo.html",
        name: "ZnajdÅº sÅ‚owo",
        icon: "ğŸ“–",
        thumb: null, // np. "img/znajdz_slowo.png", jeÅ›li dorobisz miniaturkÄ™
        description: "Szukaj sÅ‚Ã³w pasujÄ…cych do obrazkÃ³w. Åšwiaty tematyczne, levele i punkty za serie poprawnych odpowiedzi."
      }
    ];

    // Kategorie â€“ meta
    const CATEGORIES = [
      {
        id: "classic",
        name: "Gry klasyczne",
        icon: "ğŸ®",
        games: CLASSIC_GAMES
      },
      {
        id: "language",
        name: "Gry jÄ™zykowe",
        icon: "ğŸ—£ï¸",
        games: LANGUAGE_GAMES
      }
    ];

    function launchGame(file) {
      // zawsze fullscreen â€“ gra sama obsÅ‚uguje powrÃ³t do Arcade
      window.location.href = file + "?fullscreen=1";
    }

    function createGameCard(game) {
      const card = document.createElement("div");
      card.className = "game-card";

      // klikniÄ™cie caÅ‚ej karty uruchamia grÄ™,
      // poza sytuacjÄ… gdy klikamy w przycisk "Graj"
      card.onclick = (e) => {
        if (e.target.closest("button")) return;
        launchGame(game.file);
      };

      const thumbWrap = document.createElement("div");
      thumbWrap.className = "thumb-wrap";

      if (game.thumb) {
        const img = document.createElement("img");
        img.src = game.thumb;
        img.alt = game.name;
        img.onerror = () => {
          thumbWrap.innerHTML = `<div class="thumb-placeholder">${game.icon || "ğŸ®"}</div>`;
        };
        thumbWrap.appendChild(img);
      } else {
        thumbWrap.innerHTML = `<div class="thumb-placeholder">${game.icon || "ğŸ®"}</div>`;
      }

      const headline = document.createElement("div");
      headline.className = "game-headline";
      headline.innerHTML = `
        <span class="game-icon">${game.icon || "ğŸ®"}</span>
        <span class="game-name">${game.name}</span>
      `;

      const desc = document.createElement("div");
      desc.className = "game-desc";
      desc.textContent = game.description || "";

      const footer = document.createElement("div");
      footer.className = "game-footer";
      footer.innerHTML = `<span class="pill">HTML / Canvas</span>`;

      const play = document.createElement("button");
      play.className = "play-btn";
      play.textContent = "Graj";
      play.onclick = (e) => {
        e.stopPropagation();
        launchGame(game.file);
      };
      footer.appendChild(play);

      card.appendChild(thumbWrap);
      card.appendChild(headline);
      card.appendChild(desc);
      card.appendChild(footer);

      return card;
    }

    function renderGamesForCategory(catId) {
      const category = CATEGORIES.find(c => c.id === catId);
      if (!category) return;

      const gamesContainer = document.getElementById("games");
      gamesContainer.innerHTML = "";

      const sorted = [...category.games].sort((a, b) =>
        a.name.localeCompare(b.name, "pl")
      );

      sorted.forEach(game => {
        gamesContainer.appendChild(createGameCard(game));
      });
    }

    function renderCategories() {
      const catContainer = document.getElementById("categories");
      catContainer.innerHTML = "";

      CATEGORIES.forEach(cat => {
        const btn = document.createElement("button");
        btn.className = "cat-btn";
        btn.dataset.catId = cat.id;
        btn.innerHTML = `
          <span class="icon">${cat.icon}</span>
          <span>${cat.name}</span>
        `;
        btn.onclick = () => {
          // aktywny styl
          document.querySelectorAll(".cat-btn").forEach(b => {
            b.classList.toggle("active", b === btn);
          });
          renderGamesForCategory(cat.id);
        };
        catContainer.appendChild(btn);
      });

      // domyÅ›lnie aktywna pierwsza kategoria
      const first = catContainer.querySelector(".cat-btn");
      if (first) {
        first.classList.add("active");
        renderGamesForCategory(first.dataset.catId);
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      // najpierw inicjujemy wspÃ³lny topbar / auth / goÅ›cia
      ArcadeCore.initIndex({
        onReady() {
          // gdy rdzeÅ„ arcade gotowy â€“ pokazujemy caÅ‚Ä… kartÄ™ z grami
          document.getElementById("arcade-main").style.display = "block";
        }
      });

      // render kategorii i gier
      renderCategories();
    });
  </script>
</body>
</html>
